{% load static %}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>کلینیک پوست و موی زیبایی رویال | {% block title %}{% endblock title %}</title>

    




    <!-- این مقدار پیش‌فرضه، می‌تونه خالی باشه یا یه چیز عمومی -->
{% block meta_description %}
<meta name="description" content="کلینیک لیزر، زیبایی و لاغری رویال ارائه‌دهنده خدمات درمانی مدرن.">
{% endblock %}

    

    {% block meta_keywords %}{% endblock meta_keywords %}

    {% block canonical %}{% endblock canonical %}

    {% block meta_og %}{% endblock meta_og %}

    {% block extra_schema %}{% endblock extra_schema %}
    
    
    <link rel="stylesheet" href="{% static 'tailwind/output.css' %}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    

    <link rel="stylesheet" href="{% static "css/style.css" %}">
    <link rel="stylesheet" href="{% static "css/index.css" %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


    {% block extra_css %}{% endblock extra_css %}
    {% block extra_head %}{% endblock %}

</head>


<!-- آیکن زنگ نوتیفیکیشن -->
        <div id="notification-bell" style="cursor: pointer;">
            🔔
            <span id="notification-count" style="position: absolute; top: -5px; right: -5px; background-color: red; color: white; padding: 2px 6px; border-radius: 50%; font-size: 12px; display: none;">0</span>
        </div>

        <!-- نمایش پیام‌ها -->
        <div id="notification-box" style="display: none; position: absolute; background: white; border: 1px solid #ccc; padding: 10px; width: 300px; top: 70px; left: 0; z-index: 999;"></div>



    <body class="bg-gray-50">

              

        
        {% include "partials/header.html" with type=1 %}
        
        {% include "partials/messages.html" %}


          

        {% block content %}
        {% endblock content %}


        
    
        {% include "partials/footer.html" %}
        <script src="{% static 'js/myscript.js' %}"></script>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>





<!-- در main_template.html -->
<script>
$(document).ready(function() {
    // فقط برای کاربران ادمین اجرا شود
    {% if request.user.is_staff %}
    function fetchNotifications() {
        $.ajax({
            url: "{% url 'notifications:get-admin-notifications' %}",
            method: "GET",
            success: function(response) {
                const notifications = response.notifications;
                const count = notifications.length;
                const $bell = $('#notification-bell');
                const $count = $('#notification-count');
                const $box = $('#notification-box');
                
                if (count > 0) {
                    $count.text(count).show();
                    
                    let html = '<div class="notification-header">اعلان‌های اخیر</div>';
                    notifications.forEach(function(n) {
                        html += `<div class="notification-item ${n.is_read ? '' : 'unread'}">
                                    <div>${n.message}</div>
                                    <small>${n.timestamp}</small>
                                 </div>`;
                    });
                    $box.html(html);
                } else {
                    $count.hide();
                    $box.hide();
                }
            }
        });
    }

    // کلیک روی آیکن
    $('#notification-bell').click(function(e) {
        e.stopPropagation();
        $('#notification-box').toggle();
    });

    // بستن با کلیک بیرون
    $(document).click(function(e) {
        if (!$(e.target).closest('#notification-box, #notification-bell').length) {
            $('#notification-box').hide();
        }
    });

    // اجرای اولیه و هر 30 ثانیه
    fetchNotifications();
    setInterval(fetchNotifications, 30000);
    {% endif %}
});
</script>







{% block extra_js %}
{% endblock extra_js %}

        <script type="text/javascript">window.$crisp=[];window.CRISP_WEBSITE_ID="5d6dc27b-5aa5-4012-b153-84b03621eb93";(function(){d=document;s=d.createElement("script");s.src="https://client.crisp.chat/l.js";s.async=1;d.getElementsByTagName("head")[0].appendChild(s);})();</script>

    </body>

</html>